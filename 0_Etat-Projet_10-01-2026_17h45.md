# Etat du Projet Codex Nag Hammadi - 10/01/2026 17h45

## Nouvelles Fonctionnalites (Session du 10/01/2026)

### 1. VeoClient Simplifie - API Key Gemini
- **Suppression OAuth2** : Plus besoin de service account JSON
- **API Key simple** : Utilise la meme cle que Gemini/Imagen
- **Endpoint** : `generativelanguage.googleapis.com/v1beta/models/{model}:predictLongRunning`
- **Modeles disponibles** :
  - `veo-3.1-generate-preview` (Standard) - $0.40/sec
  - `veo-3.1-fast-generate-preview` (Fast) - $0.15/sec
  - `veo-2.0-generate-001` - $0.35/sec

### 2. Generation Video IA avec Selection d'Image
- **Dialogue de selection** : Choisir l'image de reference parmi les slides
- **Barre de progression amelioree** : Pourcentage + messages detailles
  - "Envoi de l'image a Veo..."
  - "Veo analyse l'image..."
  - "Generation de la video en cours..."
  - "Telechargement de la video..."
- **Telechargement automatique** : Recupere la video depuis l'URI retournee

### 3. VideoPreviewDialog - Lecteur Video Integre
- **Lecteur integre** : QVideoWidget avec controles complets
- **Auto-play** : Lecture automatique a l'ouverture
- **Boutons** :
  - Lecture/Pause, Stop
  - "Ouvrir dans VLC" (lecteur systeme)
  - "Fusionner Audio TTS" (FFmpeg)
  - "Enregistrer sous..."
- **Fusion audio** : Combine video Veo + audio TTS en 2 pistes

### 4. ApiPricingDockWidget - Panneau Tarifs & Modeles
- **Dock ancrable/detachable** (F2)
- **Selection de modeles** par categorie :
  - Texte : Gemini 2.5 Flash-Lite -> Gemini 3 Pro
  - Images : Imagen 3, Imagen 4 (Fast/Standard/Ultra)
  - Videos : Veo 2, Veo 3.1 (Fast/Standard)
  - Audio : Edge TTS (gratuit)
- **Affichage des prix** en temps reel
- **Estimation des couts** : Images + Videos = Total
- **Modification manuelle** des prix
- **Persistance** : Sauvegarde dans api_pricing.json

### 5. Boites de Dialogue Copiables
- **showCopyableError()** : Texte selectionnable + bouton "Copier"
- Utile pour debugger les erreurs API

## Fichiers Modifies/Crees

### Nouveaux fichiers :
- `src/utils/ApiPricingManager.h/.cpp` - Gestionnaire de tarifs
- `src/ui/widgets/ApiPricingDockWidget.h/.cpp` - Panneau dock
- `src/ui/dialogs/VideoPreviewDialog.h/.cpp` - Lecteur video
- `src/ui/dialogs/SessionPickerDialog.h/.cpp` - Selecteur de sessions
- `src/utils/MediaStorage.h/.cpp` - Stockage media
- `src/core/services/NarrationCleaner.h/.cpp` - Nettoyage narration

### Fichiers modifies :
- `src/api/VeoClient.h/.cpp` - Simplifie pour API Key
- `src/ui/dialogs/SlideshowDialog.h/.cpp` - Integration VideoPreview
- `src/ui/MainWindow.h/.cpp` - Integration ApiPricingDock
- `CMakeLists.txt` - Ajout Qt6::MultimediaWidgets
- `src/ui/CMakeLists.txt` - Nouveaux fichiers
- `src/utils/CMakeLists.txt` - ApiPricingManager

## Tarifs API (Janvier 2026)

### Generation de Videos (Veo)
| Modele | Prix/sec | 8 secondes |
|--------|----------|------------|
| Veo 3.1 Fast | $0.15 | ~$1.20 |
| Veo 3.1 Standard | $0.40 | ~$3.20 |
| Veo 2 | $0.35 | ~$2.80 |

### Generation d'Images (Imagen)
| Modele | Prix/image |
|--------|------------|
| Imagen 3 | $0.03 |
| Imagen 4 Fast | $0.02 |
| Imagen 4 Standard | $0.04 |
| Imagen 4 Ultra | $0.06 |

### Modeles de Texte (Gemini)
| Modele | Prix Input/1M tokens |
|--------|---------------------|
| Gemini 2.5 Flash-Lite | $0.10 |
| Gemini 2.5 Flash | $0.30 |
| Gemini 2.5 Pro | $1.25 |
| Gemini 3 Pro | $2.00 |

## Prochaines Etapes

1. **Connecter selection modele** : Utiliser le modele selectionne dans le dock pour la generation
2. **Verification automatique tarifs** : Scraping ou API pour detecter les changements
3. **Alertes promotions** : Notification si baisse de prix
4. **Generation batch videos** : Generer video pour chaque slide

## Configuration Requise

- **Cle API Gemini** : Paid Tier active sur https://aistudio.google.com/apikey
- **FFmpeg** : Pour fusion audio (optionnel)
- **Qt6 6.8.3** : Avec MultimediaWidgets
