# Etat du Projet Codex Nag Hammadi BD
**Date:** 08 janvier 2026 - 23h03
**Commit:** a323b92 - feat: Add theme system, Edge TTS neural voices, and UI improvements

---

## Resume du Projet

Application Qt6/C++ pour generer des bandes dessinees photorealistes a partir des textes gnostiques de Nag Hammadi, dans le style visuel de Denis Villeneuve.

## Fonctionnalites Implementees

### Interface Utilisateur
- **MainWindow** avec splitters: Liste traites | Viewer texte + Preview | Image + Audio
- **TreatiseListWidget**: Navigation par codex avec 49 traites classes par categorie
- **TextViewerWidget**: Affichage avec numerotation versets (Page:Paragraphe)
- **PassagePreviewWidget**: Selection de passage avec boutons generation (Image/Audio/Video)
- **ImageViewerWidget**: Affichage images generees avec zoom/sauvegarde
- **AudioPlayerWidget**: Lecteur audio integre avec controles
- **SlideshowWidget**: Mode plein ecran pour presentation

### Systeme de Themes (NOUVEAU)
- **ThemeManager**: Singleton gerant themes et styles
- Themes predefinis: Sombre (defaut) et Clair
- Couleur d'accentuation personnalisable (QColorDialog)
- Polices configurables:
  - Police interface (famille + taille 8-16pt)
  - Police texte Codex (famille + taille 8-20pt)
- Onglet "Apparence" dans Parametres avec bouton "Appliquer"
- Persistence des preferences dans config.json

### Generation de Contenu
- **PipelineController**: Orchestration Claude -> Imagen -> Affichage
- **ClaudeClient**: Analyse passages et generation prompts
- **GeminiClient**: Alternative LLM Google
- **ImagenClient**: Generation images via Google Imagen 3
- **VeoClient**: Generation videos via Google Veo 2

### Synthese Vocale
- **ElevenLabsClient**: Voix premium (necessite API key)
- **EdgeTTSClient** (NOUVEAU): Voix neurales Microsoft gratuites
  - Implementation via Python edge-tts (subprocess)
  - Voix disponibles: Henri, Denise, Eloise, Remy (FR), Antoine, Sylvie (CA), Guy, Jenny (US)
  - Selecteur de voix dans toolbar principale
  - Bouton Test pour previsualiser

### Configuration
- **Config**: Singleton JSON avec paths, APIs, apparence
- **SecureStorage**: Stockage securise des cles API (DPAPI/Keychain)
- **SettingsDialog**: 3 onglets (Cles API, Chemins, Apparence)
- Support Google AI Studio et Vertex AI

### Base de Donnees
- SQLite via **Database** singleton
- Repositories: Project, Passage, Image, Audio
- Gestion projets avec auto-sauvegarde

### Utilitaires
- **Logger**: Logs horodates console + fichier
- **MessageBox**: Dialogues avec texte selectionnable/copiable
- **TextParser**: Parsing Markdown du Codex avec detection offset pages

## Architecture des Fichiers

```
src/
├── api/
│   ├── ApiClient.h/.cpp        # Base HTTP client
│   ├── ClaudeClient.h/.cpp     # Anthropic Claude
│   ├── GeminiClient.h/.cpp     # Google Gemini
│   ├── ImagenClient.h/.cpp     # Google Imagen
│   ├── VeoClient.h/.cpp        # Google Veo
│   ├── ElevenLabsClient.h/.cpp # ElevenLabs TTS
│   ├── EdgeTTSClient.h/.cpp    # Edge TTS (Python)
│   └── VertexAuthenticator.h/.cpp # Auth Vertex AI
├── core/
│   ├── controllers/
│   │   └── PipelineController.h/.cpp
│   └── services/
│       ├── TextParser.h/.cpp
│       ├── PromptBuilder.h/.cpp
│       ├── MythicClassifier.h/.cpp
│       └── GnosticEntities.h/.cpp
├── db/
│   ├── Database.h/.cpp
│   └── repositories/
│       ├── ProjectRepository.h/.cpp
│       ├── PassageRepository.h/.cpp
│       ├── ImageRepository.h/.cpp
│       └── AudioRepository.h/.cpp
├── ui/
│   ├── MainWindow.h/.cpp
│   ├── widgets/
│   │   ├── TextViewerWidget.h/.cpp
│   │   ├── ImageViewerWidget.h/.cpp
│   │   ├── TreatiseListWidget.h/.cpp
│   │   ├── PassagePreviewWidget.h/.cpp
│   │   ├── AudioPlayerWidget.h/.cpp
│   │   └── SlideshowWidget.h/.cpp
│   └── dialogs/
│       ├── SettingsDialog.h/.cpp
│       └── ProjectDialog.h/.cpp
└── utils/
    ├── Config.h/.cpp
    ├── Logger.h/.cpp
    ├── SecureStorage.h/.cpp
    ├── ThemeManager.h/.cpp     # NOUVEAU
    └── MessageBox.h            # NOUVEAU
```

## Configuration Actuelle

```json
{
  "apis": {
    "llm_provider": "claude",
    "tts_provider": "edge",
    "google_ai_provider": "aistudio"
  },
  "appearance": {
    "theme": "dark",
    "accent_color": "#094771",
    "font_family": "Segoe UI",
    "font_size": 12,
    "text_font_family": "Consolas",
    "text_font_size": 12
  }
}
```

## Dependances

- **Qt 6.8.3**: Core, Widgets, Network, Multimedia, Sql
- **nlohmann/json**: Parsing JSON (FetchContent)
- **Python 3.x + edge-tts**: Synthese vocale neurale
- **CMake 3.16+**: Build system
- **MSVC 2022 ou MinGW**: Compilateur

## Prochaines Etapes Possibles

1. Ameliorer le pipeline de generation (prompts plus detailles)
2. Ajouter historique des generations
3. Implementer export PDF/video du diaporama
4. Ajouter plus d'options dans ThemeManager (themes personnalises)
5. Optimiser le cache des images generees

## Commandes de Build

```batch
# Build complet
build.bat

# Build seulement
build.bat build

# Lancer l'application
launch.bat
```

## Notes Session

- Systeme de themes complet implemente et teste
- Edge TTS fonctionne avec voix neurales francaises
- Interface toolbar enrichie (voix, dossiers)
- Erreurs copiables dans les dialogues
